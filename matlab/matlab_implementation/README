This code is just a proof of concept (it is slow and unreliable)